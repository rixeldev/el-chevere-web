---
import MainTitle from '@/components/MainTitle.astro'
import { SendForm } from '@/components/SendForm'
import Chat from '@/icons/Chat.astro'
import Check from '@/icons/Check.astro'
import Copy from '@/icons/Copy.astro'
import { getI18N } from '@/languages/index.ts'
import { businessEmail, businessInstagram, businessWhatsApp } from '@/libs/consts'

const email: string = businessEmail
const { currentLocale } = Astro
const i18n = getI18N({ currentLocale })
---

<div class='flex w-full max-w-6xl flex-col md:w-11/12 lg:w-10/12'>
	<MainTitle>
		<Chat class='size-8 text-accent' />
		{i18n.CONTACT}
	</MainTitle>

	<div class='mt-8 flex w-full flex-col gap-8 lg:flex-row lg:justify-between lg:gap-12'>
		<div class='flex-1 space-y-6'>
			<div class='space-y-4'>
				<p class='text-pretty text-lg leading-relaxed text-secondary'>
					<strong class='text-accent'>{i18n.CONTACT_TXT_1}</strong>
					{i18n.CONTACT_TXT_2}
					<a
						rel='noopener noreferrer'
						href={businessInstagram}
						target='_blank'
						class='font-bold text-accent underline-offset-4 transition-all duration-300 hover:text-primary hover:underline'
						>Instagram</a
					>
					{i18n.OR}
					<a
						rel='noopener noreferrer'
						href={businessWhatsApp}
						target='_blank'
						class='font-bold text-accent underline-offset-4 transition-all duration-300 hover:text-primary hover:underline'
						>WhatsApp</a
					>.
				</p>

				<p class='text-pretty text-lg leading-relaxed text-secondary'>
					{i18n.CONTACT_TXT_3}
					<strong class='text-accent'>{i18n.CONTACT_TXT_4}</strong>
					{i18n.CONTACT_TXT_5}
				</p>
			</div>

			<div
				class='group flex h-fit w-fit flex-row items-center justify-center gap-3 rounded-xl border border-accent/20 bg-glass px-4 py-3 backdrop-blur-md transition-all duration-300 hover:border-accent/40 hover:shadow-lg hover:shadow-accent/20'
			>
				<h5 id='email' class='font-semibold text-primary'>{email}</h5>

				<button
					id='copyEmailButton'
					class='relative inline-flex items-center justify-center'
					aria-label='Copy email'
				>
					<Copy
						id='copyEmailIcon'
						class='inline-block h-5 w-5 cursor-pointer text-accent transition-all duration-300 hover:scale-110 hover:text-primary'
					/>

					<Check id='copiedEmailIcon' class='hidden h-5 w-5 text-success' />
				</button>
			</div>
		</div>

		<div class='flex-1 lg:max-w-md'>
			<SendForm client:visible currentLocale={currentLocale} />
		</div>
	</div>
</div>

<script>
	import { getI18N } from '@/languages/index'
	import { businessEmail } from '@/libs/consts'
	import { $ } from '@/libs/dom-selector.ts'

	document.addEventListener('astro:page-load', () => {
		const copyEmailButton = $('#copyEmailButton')
		const copyEmailIcon = $('#copyEmailIcon')
		const copiedEmailIcon = $('#copiedEmailIcon')
		const currentLocale = navigator.language.split('-')[0]
		const i18n = getI18N({ currentLocale })

		copyEmailButton?.addEventListener('click', () => {
			copyEmailIcon?.classList.remove('inline-block')
			copyEmailIcon?.classList.add('hidden')
			copiedEmailIcon?.classList.add('inline-block')
			copiedEmailIcon?.classList.remove('hidden')

			navigator.clipboard.writeText(businessEmail)

			window.toast({
				dismissible: true,
				icon: true,
				location: 'bottom-center',
				title: i18n.EMAIL_COPIED,
				type: 'success',
			})

			setTimeout(() => {
				copyEmailIcon?.classList.add('inline-block')
				copyEmailIcon?.classList.remove('hidden')
				copiedEmailIcon?.classList.remove('inline-block')
				copiedEmailIcon?.classList.add('hidden')
			}, 3000)
		})
	})
</script>
